"use strict";(self.webpackChunkvalex=self.webpackChunkvalex||[]).push([[217],{7217:(H,v,l)=>{l.r(v),l.d(v,{PaymentLinkCreateModule:()=>Y});var u=l(6895),g=l(3022),r=l(4006),e=l(4650),y=l(2594),C=l(9549),h=l(1894);function x(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio."),e.qZA())}function k(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio."),e.qZA())}function Z(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function b(i,m){if(1&i&&(e.TgZ(0,"option",33),e._uU(1),e.qZA()),2&i){const n=m.$implicit;e.Q6J("value",n.id),e.xp6(1),e.hij("",n.description," ")}}function T(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function F(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function P(i,m){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio."),e.qZA())}function I(i,m){if(1&i){const n=e.EpF();e.TgZ(0,"ngx-dropzone-image-preview",34),e.NdJ("removed",function(){const a=e.CHM(n).$implicit,p=e.oxw();return e.KtG(p.onRemoveComplement(a))}),e.TgZ(1,"ngx-dropzone-label"),e._uU(2),e.qZA()()}if(2&i){const n=m.$implicit;e.Q6J("file",n)("removable",!0),e.xp6(2),e.AsE("",n.name," (",n.type,") ")}}function A(i,m){1&i&&(e.TgZ(0,"div",35)(1,"label",36),e._uU(2," La imagen debe tener formato jpg o png\\n, tener m\xe1s de 700 p\xedxeles en uno de sus lados. "),e.qZA()())}const L=function(){return["/payment-link"]};let O=(()=>{class i{constructor(n,t,o){this.formGroup=n,this.PaymentLinksService=t,this.router=o,this.filesComplement=[],this.validate_img=!1,this.widthMin=700,this.heightMin=700,this.currencyPipe=new u.H9("es-CO"),this.files=[],this.MultiseletDropDown=[],this.MultiseletDropDown1=[],this.SingleSearchItem=[],this.SingleSearchSettings={},this.DisableItem=[],this.DisableSettings={},this.groupDropdown=[],this.SingleItems=[],this.SingleSettings={},this.multipleItems=[],this.multipleSettings={},this.groupItems=[],this.groupSettings={},this.inputValue=new r.NI(""),this.taxTypes=[{id:1,description:"19%"},{id:2,description:"0%"}]}ngOnInit(){this.linkForm=this.formGroup.group({price:["",[r.kI.required]],reference:["",[r.kI.required]],link_expiration:["",[r.kI.required]],description:["",[r.kI.required]],tax_type:["",[r.kI.required]],total:["",[]]})}get name(){return this.linkForm.get("name")}selectFileComplement(n){0==this.filesComplement.length&&this.filesComplement.push(...n.addedFiles)}onRemoveComplement(n){this.filesComplement.splice(this.filesComplement.indexOf(n),1)}onValidatePixels(n){return new Promise((t,o)=>{const a=new Image;a.src=URL.createObjectURL(n),a.onload=p=>{console.log(p),(p.path[0].height>=this.heightMin||p.path[0].width>=this.widthMin)&&t(!0),t(!1)}})}onSelect(n){console.log("ev",n),this.files.push(...n.addedFiles)}onRemove(n){this.files.splice(this.files.indexOf(n),1)}formatInput(n){let o=parseFloat(n.target.value.replace(/\D/g,""));isNaN(o)&&(o=0);let a=this.linkForm.value;""==a.tax_type?this.total_price=0:"1"==a.tax_type?(this.total_price=19*o/100,this.total_price=o+this.total_price,this.total_price=this.formatInputTotal(this.total_price)):(this.total_price=0*o/100,this.total_price=o+this.total_price,this.total_price=this.formatInputTotal(this.total_price));const p=o.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0});this.linkForm.get("price")?.setValue(p,{emitEvent:!1})}formatInputTotal(n){let t=parseFloat(n);return isNaN(t)&&(t=0),t.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0})}CalcTax(n){const t=n.target;let o=this.linkForm.get("price")?.value.replace(/\D/g,"");"1"==t.value?(this.total_price=19*parseInt(o)/100,this.total_price=parseInt(o)+this.total_price,this.total_price=this.formatInputTotal(this.total_price)):(this.total_price=0*parseInt(o)/100,this.total_price=parseInt(o)+this.total_price,this.total_price=this.formatInputTotal(this.total_price))}submitbutton(){const n=this.linkForm.get("price")?.value.replace(/\D/g,"");if(this.linkForm.get("price")?.setValue(n,{emitEvent:!1}),this.linkForm.valid){let s=this.linkForm.value,V=this.filesComplement.length;const j=this.total_price.replace(/\D/g,"");for(var t=new Date,o=0;o<this.filesComplement.length;o++){this.file=this.filesComplement[o];let R=this.file.type.split("/")[1];const G=[t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()].map($=>new Date($).getTime());this.new_file=this.renameFile(this.file,"link-image-"+G+o+"."+R)}const f=new FormData;f.append("codeproduct",s.reference),f.append("description",s.description),f.append("subtotal",s.price),f.append("taxid",s.tax_type),f.append("total",j),f.append("enddate",s.link_expiration),V>0&&f.append("image",this.new_file),this.PaymentLinksService.CreateLink(f).subscribe(_=>{this.router.navigate(["payment-link"]).then(()=>{})},_=>console.log(_))}else for(let s in this.linkForm.controls)this.linkForm.controls[s].markAsTouched()}renameFile(n,t){return new File([n],t,{type:n.type,lastModified:n.lastModified})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(r.qu),e.Y36(y.r),e.Y36(g.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-payment-link-create"]],decls:64,vars:17,consts:[[1,"container-fluid"],[1,"breadcrumb-header","justify-content-between"],[1,"left-content"],[1,"main-content-title","mg-b-1","mg-b-lg-1"],[1,"mg-b-0"],[1,"main-dashboard-header-right"],[1,"btn","btn-success-dyner-green","btn-block",3,"routerLink"],[1,"fas","fa-chevron-left"],[1,"row","row-sm"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"mg-b-0","tx-14"],["placeholder","Escribe una descripci\xf3n","formControlName","description","maxlength","200","required","",1,"form-control"],[4,"ngIf"],["placeholder","Escribe el n\xfamero de referencia","formControlName","reference","maxlength","150","required","","maxlength","15",1,"form-control"],[1,"col-md-4"],["type","text","placeholder","Digita el valor de tu producto o servicio","formControlName","price","maxlength","150","required","","maxlength","13",1,"form-control",3,"input"],["id","tax_type","formControlName","tax_type","placeholder","Impuesto","required","",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Total","formControlName","total","maxlength","150","maxlength","13","readonly","",1,"form-control",3,"value"],[1,"col-md-4","mt-2"],["formControlName","link_expiration","type","date",1,"form-control"],[1,"offset-md-3","col-md-6","mt-4"],[3,"expandable","disableClick","accept","multiple","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["align","center","class","mt-3",4,"ngIf"],["align","center",1,"col-12","col-sm-12","col-lg-12","col-xl-12","mt-4"],[1,"col-md-2"],[1,"btn","btn-success-dyner-green","btn-block",3,"click"],[3,"value"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed"],["align","center",1,"mt-3"],[2,"color","red"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),e._uU(5,"LINKS DE PAGO"),e.qZA(),e.TgZ(6,"p",4),e._uU(7,"Crea tu link de pago"),e.qZA()()(),e.TgZ(8,"div",5)(9,"div")(10,"button",6),e._UZ(11,"i",7),e._uU(12," Volver "),e.qZA()()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"form",12)(18,"div",13)(19,"div",14)(20,"p",15),e._uU(21,"Descripci\xf3n"),e.qZA(),e._UZ(22,"input",16),e.YNc(23,x,2,0,"mat-error",17),e.qZA(),e.TgZ(24,"div",14)(25,"p",15),e._uU(26,"Referencia"),e.qZA(),e._UZ(27,"input",18),e.YNc(28,k,2,0,"mat-error",17),e.qZA(),e.TgZ(29,"div",19)(30,"p",15),e._uU(31,"Subtotal ($) COP"),e.qZA(),e.TgZ(32,"input",20),e.NdJ("input",function(a){return t.formatInput(a)}),e.qZA(),e.YNc(33,Z,2,0,"mat-error",17),e.qZA(),e.TgZ(34,"div",19)(35,"p",15),e._uU(36,"Iva"),e.qZA(),e.TgZ(37,"select",21),e.NdJ("change",function(a){return t.CalcTax(a)}),e.YNc(38,b,2,2,"option",22),e.qZA(),e.YNc(39,T,2,0,"mat-error",17),e.qZA(),e.TgZ(40,"div",19)(41,"p",15),e._uU(42,"Total ($) COP"),e.qZA(),e._UZ(43,"input",23),e.YNc(44,F,2,0,"mat-error",17),e.qZA()(),e.TgZ(45,"div",13)(46,"div",24)(47,"p",15),e._uU(48,"Vencimiento del link"),e.qZA(),e._UZ(49,"input",25),e.YNc(50,P,2,0,"mat-error",17),e.qZA()(),e.TgZ(51,"div",13)(52,"div",26)(53,"p",15),e._uU(54," Imagen del producto o servicio (opcional) "),e.qZA(),e.TgZ(55,"ngx-dropzone",27),e.NdJ("change",function(a){return t.selectFileComplement(a)}),e.TgZ(56,"ngx-dropzone-label"),e._uU(57,"\xa1Suelta tu imagen aqui! "),e.qZA(),e.YNc(58,I,3,4,"ngx-dropzone-image-preview",28),e.qZA(),e.YNc(59,A,3,0,"div",29),e.qZA()()(),e.TgZ(60,"div",30)(61,"div",31)(62,"button",32),e.NdJ("click",function(){return t.submitbutton()}),e._uU(63," Crear link de pago "),e.qZA()()()()()()()()),2&n){let o,a,p,c,d,s;e.xp6(10),e.Q6J("routerLink",e.DdM(16,L)),e.xp6(7),e.Q6J("formGroup",t.linkForm),e.xp6(6),e.Q6J("ngIf",(null==(o=t.linkForm.get("description"))?null:o.hasError("required"))&&(null==(o=t.linkForm.get("description"))?null:o.touched)),e.xp6(5),e.Q6J("ngIf",(null==(a=t.linkForm.get("reference"))?null:a.hasError("required"))&&(null==(a=t.linkForm.get("reference"))?null:a.touched)),e.xp6(5),e.Q6J("ngIf",(null==(p=t.linkForm.get("price"))?null:p.hasError("required"))&&(null==(p=t.linkForm.get("price"))?null:p.touched)),e.xp6(5),e.Q6J("ngForOf",t.taxTypes),e.xp6(1),e.Q6J("ngIf",(null==(c=t.linkForm.get("tax_type"))?null:c.hasError("required"))&&(null==(c=t.linkForm.get("tax_type"))?null:c.touched)),e.xp6(4),e.Q6J("value",t.total_price),e.xp6(1),e.Q6J("ngIf",(null==(d=t.linkForm.get("total"))?null:d.hasError("required"))&&(null==(d=t.linkForm.get("total"))?null:d.touched)),e.xp6(6),e.Q6J("ngIf",(null==(s=t.linkForm.get("link_expiration"))?null:s.hasError("required"))&&(null==(s=t.linkForm.get("link_expiration"))?null:s.touched)),e.xp6(5),e.Q6J("expandable",!0)("disableClick",!1)("accept","image/*")("multiple",!1),e.xp6(3),e.Q6J("ngForOf",t.filesComplement),e.xp6(1),e.Q6J("ngIf",t.validate_img)}},dependencies:[u.sg,u.O5,g.rH,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.Q7,r.nD,C.TO,r.sg,r.u,h._f,h.NP,h.sv],styles:[".form-control[_ngcontent-%COMP%]{background-color:#dde2ef;opacity:1;display:block;width:100%;height:inherit;padding:.375rem .75rem;font-size:.875rem;font-weight:400;line-height:1.5;color:#4d5875;background-color:#fff;background-clip:padding-box;border:1px solid #e1e5ef;border-radius:3px;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.mat-error[_ngcontent-%COMP%]{color:#f44336}.mat-form-field[_ngcontent-%COMP%]{display:block;position:relative;text-align:left}  .mat-form-field-wrapper{padding-bottom:0}  .mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-datepicker-toggle-default-icon, .mat-form-field[_ngcontent-%COMP%]:not(.mat-form-field-appearance-legacy)   .mat-form-field-suffix[_ngcontent-%COMP%]   .mat-datepicker-toggle-default-icon[_ngcontent-%COMP%]{display:inherit;width:1.5em;height:1.5em}  .mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:0!important}  .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{background-color:#fff}  .mat-form-field-appearance-fill .mat-form-field-infix{padding:0}  .mat-form-field-infix{border-top-width:0px!important}  .mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-datepicker-toggle-default-icon{width:1.5em;height:1.5em}  .mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button, .mat-form-field[_ngcontent-%COMP%]:not(.mat-form-field-appearance-legacy)   .mat-form-field-suffix[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{display:inline-flex;font-size:inherit;width:2.5em;height:2.5em}  .mat-form-field-appearance-fill .mat-form-field-flex{background-color:#fff}  .mat-form-field-appearance-fill{color:#fff!important}  .mat-input-underline{display:none}  .mat-form-field-appearance-legacy .mat-form-field-underline{height:0!important}  .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}  .mat-form-field-appearance-legacy .mat-form-field-infix{padding:0}  .mat-form-field.mat-warn .mat-input-element, .mat-form-field-invalid[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{caret-color:#fff!important}  .mat-form-field-underline{display:none}"]}),i})();var q=l(529);const N=[{path:"",children:[{path:"",title:"Dyner - Link de pago",component:O}]}];let w=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.Bz.forChild(N),q.JF,r.u5,g.Bz]}),i})();var D=l(6205),M=l(3333),U=l(2834),J=l(3626),E=l(1066),z=l(1844),S=l(769),Q=l(5158);let Y=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.ez,w,D.X,M.IJ,U.z,r.u5,J.p0,E.x,r.UX,C.lN,z.Ti,h.bB,Q.zz,S.zh]}),i})()}}]);